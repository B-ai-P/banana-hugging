<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이미지 갤러리</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="gallery-header">
            <h1>📸 챗붕이들이 만든 이미지</h1>
            <button onclick="location.href='/'" class="back-btn">🏠 메인으로</button>
        </div>

        <div class="sort-buttons">
            <button class="sort-btn {% if current_sort == 'newest' %}active{% endif %}" 
                    onclick="location.href='?sort=newest'">최신순</button>
            <button class="sort-btn {% if current_sort == 'oldest' %}active{% endif %}" 
                    onclick="location.href='?sort=oldest'">오래된순</button>
            <button class="sort-btn {% if current_sort == 'likes' %}active{% endif %}" 
                    onclick="location.href='?sort=likes'">좋아요순</button>
        </div>

        <div class="gallery-grid">
            {% for image in images %}
            <div class="gallery-item" onclick="openModal('{{ image.id }}')">
                <img src="{{ image.result_image }}" alt="생성된 이미지">
                <div class="gallery-item-info">
                    <span class="likes">❤️ {{ image.likes }}</span>
                </div>
            </div>
            {% endfor %}
        </div>

        {% if not images %}
        <div class="empty-gallery">
            <p>아직 생성된 이미지가 없습니다.</p>
            <button onclick="location.href='/'" class="generate-btn">첫 이미지 만들기</button>
        </div>
        {% endif %}
    </div>

    <!-- 모달 -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-body">
                <div class="modal-left">
                    <img id="modalImage" src="" alt="상세 이미지">
                </div>
                <div class="modal-right">
                    <div class="modal-header">
                        <span id="modalDate"></span>
                        <button id="likeBtn" class="like-btn">❤️ <span id="likeCount">0</span></button>
                    </div>
                    <div class="modal-info">
                        <div class="chat-item user">
                            <strong>👤 사용자:</strong>
                            <p id="modalPrompt"></p>
                            <div id="modalImages" class="attached-images"></div>
                        </div>
                        <div class="chat-item ai">
                            <strong>🤖 Gemini:</strong>
                            <p id="modalResponse"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='gallery.js') }}"></script>
</body>
</html>
